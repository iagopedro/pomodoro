<!-- 
  Template do Pomodoro Timer
  Angular v20 - Aplica√ß√£o standalone com Signals e Control Flow
-->
<div class="pomodoro-container">
  <!-- Cards alinhados horizontalmente -->
  <div class="cards-row" [class.config-visible]="showConfig()">
    <!-- Timer Principal -->
    <div class="timer-card">
      <!-- Bot√£o de tema no canto superior esquerdo -->
      <button 
        class="btn-theme-toggle" 
        (click)="toggleThemeDropdown()" 
        [title]="'Tema: ' + currentTheme().name"
      >
        <span class="theme-icon">{{ currentTheme().icon }}</span>
      </button>
      
      <!-- Dropdown de temas -->
      @if (showThemeDropdown()) {
        <div class="theme-dropdown">
          @for (theme of themes(); track theme.id) {
            <button 
              class="theme-option"
              [class.active]="theme.id === currentTheme().id"
              (click)="selectTheme(theme.id)"
              [style.--theme-preview]="theme.primary"
            >
              <span class="theme-option-icon">{{ theme.icon }}</span>
              <span class="theme-option-name">{{ theme.name }}</span>
              @if (theme.id === currentTheme().id) {
                <span class="theme-option-check">‚úì</span>
              }
            </button>
          }
        </div>
      }
      
      <!-- Bot√£o de √°udio no canto superior direito -->
      <button 
        class="btn-audio-toggle" 
        (click)="toggleAudio()" 
        [class.enabled]="audioEnabled()"
        [title]="audioEnabled() ? 'Desativar som' : 'Ativar som'"
      >
        @if (audioEnabled()) {
          üîä
        } @else {
          üîá
        }
      </button>
      
      <div class="title-box">
        <h1>üçÖ {{ title }}</h1>
      </div>
      <div class="timer-info">
        <h2>{{ getStateDisplayName() }}</h2>
        <div class="timer-display">
          <div class="time-text">{{ formattedTime() }}</div>
          <div class="progress-bar">
            <div class="progress" [style.width.%]="progress()"></div>
          </div>
        </div>
      </div>
      
      <div class="bottom-section">
        <div class="session-info">
          <span class="chip">Sess√£o {{ currentSession() }}</span>
          <span class="chip accent">{{ totalSessions() }} completas</span>
        </div>
        
        <div class="control-buttons">
          <!-- Usando @if - novo control flow do Angular v20 -->
          @if (isRunning()) {
            <button class="btn-fab warn" (click)="pauseTimer()">‚è∏Ô∏è</button>
          } @else {
            <button class="btn-fab primary" (click)="startTimer()">‚ñ∂Ô∏è</button>
          }
          
          <button class="btn" (click)="resetTimer()">üîÑ</button>
          
          @if (isRunning()) {
            <button class="btn skip-btn" (click)="skipSession()">‚è≠Ô∏è</button>
          }
          
          <button class="btn" (click)="toggleConfig()" [disabled]="showConfig()">
            ‚öôÔ∏è
          </button>
        </div>
      </div>
    </div>
    
    <!-- Configura√ß√µes -->
    @if (showConfig()) {
      <div class="config-card" [class.closing]="isClosing()">
        <button class="btn-close" (click)="toggleConfig()" title="Fechar configura√ß√µes">‚úï</button>
        <h3>‚öôÔ∏è Configura√ß√µes</h3>
        
        <div class="config-grid">
          <div class="form-field">
            <label>Tempo de Trabalho (min)</label>
            <input type="number" [(ngModel)]="tempWorkTime" min="1" max="60">
          </div>
          
          <div class="form-field">
            <label>Tempo de Pausa (min)</label>
            <input type="number" [(ngModel)]="tempBreakTime" min="1" max="30">
          </div>
          
          <div class="form-field">
            <label>Pausa Longa (min)</label>
            <input type="number" [(ngModel)]="tempLongBreakTime" min="1" max="60">
          </div>
        </div>
        
        <button class="btn primary" (click)="updateConfig()" [disabled]="isRunning()">
          üíæ Salvar Configura√ß√µes
        </button>
      </div>
    }
  </div>
</div>
